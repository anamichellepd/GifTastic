<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>GifTastic</title>
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- <button data-search="happy">HAPPY</button>
    <button data-search="frustrated">FRUSTRATED</button>
    <button data-search="sleepy">SLEEPY</button>
    -->
    <form>
      <div class="form-group">
        <label for="search">Search Term:</label>
        <input class="form-control" id="search" />
      </div>
    </form>
    <button type="search" class="btn btn-primary" id="search-btn">
      Search
    </button>
    <button type="clear" class="btn btn-primary" id="clear-btn">
      Clear Results
    </button>
    <div id="buttonArea"></div>
    <div id="GIFArea"></div>

    <script type="text/javascript">
      var APIkey = "YjUF4DPZXXXiu7JKzVE6d9BPQ2VxVt2Q";
      var query = "";
      var numResults = 10;
      var queryURL = "https://api.giphy.com/v1/gifs/search?apikey=" + APIkey;

      //Arrays

      const topics = [
        "happy",
        "sad",
        "loud",
        "tired",
        "energized",
        "thankful",
        "sloppy",
        "smart"
      ];
      function runQuery(numResults, queryURL) {
        $.ajax({ url: queryURL, method: "GET" }).done(function(GIFData) {
          console.log(GIFData.data[0].rating);
          for (let k = 0; k < GIFData.data.length; k++) {
            $("#GIFArea").prepend(
              "<p>Rating: " + GIFData.data[k].rating + "</p>"
            );
            $("#GIFArea").prepend(
              "<img src ='" + GIFData.data[k].images.downsized.url + "'>"
            );
          }
          console.log(queryURL);
          console.log(GIFData);
        });
      }
      $("#search-btn").on("click", function() {
        var queryTerm = $("#search")
          .val()
          .trim();
        var newURL = queryURL + "&q=" + queryTerm;

        runQuery(numResults, newURL);
        // return false;
      });

      for (let i = 0; i < topics.length; i++) {
        const mood = topics[i];

        $("#buttonArea").append(
          "<button class=gifButton data-search=" +
            mood +
            " >" +
            mood +
            "</button>"
        );
      }

      $(".gifButton").on("click", function() {
        var x = $(this).data("search");
        console.log(x);

        var queryURL =
          "https://api.giphy.com/v1/gifs/search?q=" +
          x +
          "&api_key=YjUF4DPZXXXiu7JKzVE6d9BPQ2VxVt2Q&limit=10";
        console.log(queryURL);

        $.ajax({
          url: queryURL,
          method: "GET"
        }).done(function(response) {
          console.log(response.data[0].rating);
          for (let j = 0; j < response.data.length; j++) {
            $("#GIFArea").prepend(
              "<p>Rating: " + response.data[j].rating + "</p>"
            );
            $("#GIFArea").prepend(
              "<img src ='" + response.data[j].images.downsized.url + "'>"
            );
          }
        });
        // $("#search-btn").on("click", function(event) {
        //   event.preventDefault();
        //   $.ajax({
        //     method: "GET",
        //     url: queryUrl
        //   }).then(function(response) {
        //     console.log(response);
        //     console.log(response.response.docs[2].abstract);
        //     //    for(var i=0; i<response.response.docs.length; i++){
        //     //     $('#buttonArea').append('<button'+response.response.docs[i].abstract+'</p>');
        //   });
        // });
      });
    </script>
  </body>
</html>
